<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é—¨ç¦ç”µæ¢¯å¡ä¿®æ”¹å¸¸ç”¨äººå‘˜</title>
    <link rel="icon" href="../favicon.ico">
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <meta name="keywords" content="é—¨ç¦,ç”µæ¢¯å¡,ä¿®æ”¹,å¸¸ç”¨äººå‘˜,é—¨ç¦ç”µæ¢¯å¡ä¿®æ”¹å¸¸ç”¨äººå‘˜,é—¨ç¦ç”µæ¢¯å¡,ä¿®æ”¹å¸¸ç”¨äººå‘˜,æŸ¥è¯¢">
    <meta name="description" content="é—¨ç¦ç”µæ¢¯å¡ä¿®æ”¹å¸¸ç”¨äººå‘˜æŸ¥è¯¢é¡µé¢ï¼Œåœ¨è¿™é‡Œæ‚¨å¯ä»¥æŸ¥è¯¢åˆ°ä¼—å¤šåˆ¶å¡äººçš„è”ç³»æ–¹å¼ï¼Œä»¥ä¾¿è”ç³»ã€å’¨è¯¢ã€‚">
    <meta name="robots" content="all">
    <script type="module" src="https://unpkg.com/lu2/theme/edge/js/common/ui/LightTip.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/lu2/theme/edge/css/common/ui/LightTip.css">
    <link rel="stylesheet" href="https://unpkg.com/lu2/theme/edge/css/common/ui/Tips.css">
    <script type="module" src="https://unpkg.com/lu2/theme/edge/js/common/ui/Tips.js"></script>
    <!-- é…ç½® Tailwind è‡ªå®šä¹‰ä¸»é¢˜ -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#4080FF',
                        accent: '#0FC6C2',
                        neutral: '#F5F7FA',
                        dark: '#1D2129',
                        danger: '#F53F3F',
                        like: '#FF4D4F',
                        dislike: '#722ED1',
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        'card': '0 4px 20px rgba(0, 0, 0, 0.08)',
                        'hover': '0 8px 30px rgba(22, 93, 255, 0.15)',
                    }
                },
            }
        }
    </script>
    <style>
        .head_img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            overflow: hidden;
            object-fit: cover;
            /* é˜²æ­¢å›¾ç‰‡æ‹‰ä¼¸ */
        }

        .overflow-x-auto {
            max-height: calc(100vh - 200px);
            /* é€‚é…é¡µé¢å¸ƒå±€çš„é«˜åº¦é™åˆ¶ */
            overflow-y: auto;
        }

        th {
            white-space: nowrap;
        }

        .vote-btn {
            transition: all 0.2s ease;
            cursor: pointer;
        }

            .vote-btn:hover {
                transform: scale(1.1);
            }

            .vote-btn.liked {
                color: #FF4D4F;
                font-weight: bold;
            }

            .vote-btn.disliked {
                color: #722ED1;
                font-weight: bold;
            }

        .vote-count {
            font-size: 0.9rem;
            margin-left: 4px;
        }
    </style>
</head>

<body class="font-inter bg-neutral min-h-screen text-dark">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <header class="bg-white shadow-sm sticky top-0 z-50 transition-all duration-300" id="header">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <!-- ä¼˜åŒ–logoæ˜¾ç¤º -->
                <div class="text-primary text-2xl flex items-center">
                    <img src="../favicon.ico" alt="logo" class="w-10 h-10 object-contain">
                </div>
                <a href="./" rel="noopener noreferrer">
                    <h1 class="text-[clamp(1.2rem,3vw,1.8rem)] font-bold text-primary">é—¨ç¦ç”µæ¢¯å¡ä¿®æ”¹å¸¸ç”¨äººå‘˜</h1>
                </a>
            </div>
            <div class="text-sm text-gray-500 hidden md:block">
                <span id="lastUpdate">æ•°æ®åŠ è½½ä¸­...</span>
            </div>
        </div>
    </header>

    <!-- ä¸»å†…å®¹åŒº -->
    <main class="container mx-auto px-4 py-8">
        <!-- é€‰é¡¹å¡åŒºåŸŸ - ä¿®å¤ä»£ç†æŒ‰é’®é€‰æ‹©å™¨ -->
        <div class="mb-6 border-b border-gray-200">
            <div class="flex space-x-8">
                <button id="indexTab" class="py-3 px-4 text-gray-500 hover:text-primary hover:border-primary border-b-2 border-transparent font-medium text-lg transition-all duration-300 active:scale-95">
                    é¦–é¡µ
                </button>
                <button id="icTab" class="py-3 px-4 text-gray-500 hover:text-primary hover:border-primary border-b-2 border-transparent font-medium text-lg transition-all duration-300 active:scale-95">
                    IC
                </button>
                <button id="cpuTab" class="py-3 px-4 text-gray-500 hover:text-primary hover:border-primary border-b-2 border-transparent font-medium text-lg transition-all duration-300 active:scale-95">
                    CPU
                </button>
                <button id="proxyTab" class="py-3 px-4 text-primary border-b-2 border-primary font-medium text-lg transition-all duration-300 active:scale-95">
                    ä»£ç†
                </button>
            </div>
        </div>

        <!-- æœç´¢åŒºåŸŸ -->
        <div class="mb-8 bg-white rounded-xl shadow-card p-6 transition-all duration-300 hover:shadow-hover">
            <div class="relative">
                <input type="text" id="searchInput" placeholder="è¾“å…¥å…³é”®è¯æœç´¢ï¼ˆå¦‚ï¼šæ— èŠçŠ¬ï¼‰" class="w-full pl-10 pr-4 py-3 rounded-lg border border-gray-200 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all duration-300 text-lg">
                <div class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">ğŸ”</div>
                <button id="clearSearch" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 hidden">
                    Ã—
                </button>
            </div>
            <div class="mt-4 flex flex-wrap gap-2">
                <span class="text-sm text-gray-500">â„¹ï¸ æ”¯æŒæ¨¡ç³Šæœç´¢ï¼ŒåŒ¹é…ç³»ç»ŸååŒ…å«å…³é”®è¯çš„ç»“æœ</span>
                <span class="text-sm text-gray-500">âš ï¸ æ’åä¸åˆ†å‰åï¼éšæœºæ’åï¼</span>
            </div>
        </div>

        <!-- è¡¨æ ¼åŒºåŸŸ - ä¿®å¤è¡¨å¤´stickyã€åˆ—æ•°åŒ¹é…å’Œæ‚¬ç©ºé—®é¢˜ -->
        <div class="bg-white rounded-xl shadow-card overflow-hidden transition-all duration-300 hover:shadow-hover">
            <div class="table-scroll-container overflow-x-auto">
                <table class="w-full min-w-[868px]">
                    <thead>
                        <!-- è¡¨å¤´stickyå®šä½ï¼Œz-indexç¡®ä¿åœ¨å†…å®¹ä¸Šæ–¹ -->
                        <tr class="bg-primary text-white sticky top-0 z-30">
                            <th class="py-4 px-6 text-left text-lg font-semibold">å¤´åƒ</th>
                            <th class="py-4 px-6 text-center text-lg font-semibold">æ˜µç§°</th>
                            <th class="py-4 px-6 text-center text-lg font-semibold">QQ</th>
                            <th class="py-4 px-6 text-center text-lg font-semibold">æè¿°</th>
                            <th class="py-4 px-6 text-center text-lg font-semibold">æŠ•ç¥¨</th>
                        </tr>
                    </thead>
                    <tbody id="systemTableBody" class="divide-y divide-gray-100">
                        <tr>
                            <td colspan="5" class="py-16 text-center text-gray-500">
                                <div class="animate-spin text-2xl mb-4 block">âŸ³</div>
                                <p>æ•°æ®åŠ è½½ä¸­ï¼Œè¯·ç¨å€™...</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="noResult" class="py-16 text-center text-gray-500 hidden">
                <div class="text-3xl mb-4 block text-gray-300">ğŸ”</div>
                <p>æœªæ‰¾åˆ°åŒ¹é…çš„äººç‰©ï¼Œè¯·å°è¯•å…¶ä»–æœç´¢å…³é”®è¯</p>
            </div>
        </div>
    </main>

    <!-- é¡µè„š -->
    <footer class="bg-white mt-12 py-6 border-t border-gray-100">
        <div class="container mx-auto px-4 text-center text-gray-500 text-sm">
            <p>éº¦ç”°åŠ©æ‰‹ç³»ç»Ÿæ”¯æŒæŸ¥è¯¢ | ä»…ä¸ºæ–¹ä¾¿å¡åŒ ä½¿ç”¨ï¼Œç¦æ­¢ç”¨äºè¿æ³•ç”¨é€” | Ver:1.20</p>

        </div>
    </footer>

    <!-- æ›´æ–°æç¤ºå¼¹çª— -->
    <div id="updateModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 transform transition-all duration-300 scale-95 opacity-0" id="modalContent">
            <div class="text-center mb-6">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary/10 text-primary mb-4">
                    <div class="text-2xl">âŸ³</div>
                </div>
                <h3 class="text-xl font-bold text-dark mb-2">æ•°æ®æ›´æ–°æç¤º</h3>
                <p class="text-gray-500">å·²æœ‰1å°æ—¶æœªæ›´æ–°æ•°æ®ï¼Œæ˜¯å¦åˆ·æ–°è·å–æœ€æ–°ä¿¡æ¯ï¼Ÿ</p>
            </div>
            <div class="flex space-x-4">
                <button id="cancelUpdate" class="flex-1 py-3 px-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-gray-50 transition-all duration-300">
                    ç¨åæ›´æ–°
                </button>
                <button id="confirmUpdate" class="flex-1 py-3 px-4 bg-primary text-white rounded-lg hover:bg-primary/90 transition-all duration-300">
                    ç«‹å³æ›´æ–°
                </button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let systemData = {};
        let searchKeyword = '';
        let voteData = {}; // å­˜å‚¨æŠ•ç¥¨æ•°æ® { qq: { likes: 0, dislikes: 0 } }
        let userVotes = {}; // å­˜å‚¨å½“å‰ç”¨æˆ·çš„æŠ•ç¥¨è®°å½• { qq: 'like'/'dislike'/null }

        // DOMå…ƒç´ 
        const searchInput = document.getElementById('searchInput');
        const clearSearch = document.getElementById('clearSearch');
        const tableBody = document.getElementById('systemTableBody');
        const noResult = document.getElementById('noResult');
        const lastUpdate = document.getElementById('lastUpdate');
        const updateModal = document.getElementById('updateModal');
        const modalContent = document.getElementById('modalContent');
        const confirmUpdate = document.getElementById('confirmUpdate');
        const cancelUpdate = document.getElementById('cancelUpdate');
        const header = document.getElementById('header');
        const indexTab = document.getElementById('indexTab');
        const icTab = document.getElementById('icTab');
        const cpuTab = document.getElementById('cpuTab');
        const proxyTab = document.getElementById('proxyTab');

        // é¡µé¢æ»šåŠ¨æ•ˆæœ
        window.addEventListener('scroll', () => {
            if (window.scrollY > 10) {
                header.classList.add('py-2', 'shadow');
                header.classList.remove('py-4', 'shadow-sm');
            } else {
                header.classList.add('py-4', 'shadow-sm');
                header.classList.remove('py-2', 'shadow');
            }
        });

        // é€‰é¡¹å¡åˆ‡æ¢
        indexTab.addEventListener('click', () => {
            window.location.href = '../';
            updateTabStatus(indexTab);
        });

        icTab.addEventListener('click', () => {
            window.location.href = '../ic/';
            updateTabStatus(icTab);
        });

        cpuTab.addEventListener('click', () => {
            window.location.href = '../cpu/';
            updateTabStatus(cpuTab);
        });

        proxyTab.addEventListener('click', () => {
            updateTabStatus(proxyTab);
        });

        // ç»Ÿä¸€æ›´æ–°é€‰é¡¹å¡çŠ¶æ€
        function updateTabStatus(activeTab) {
            [indexTab, icTab, cpuTab, proxyTab].forEach(tab => {
                if (tab === activeTab) {
                    tab.classList.add('text-primary', 'border-primary');
                    tab.classList.remove('text-gray-500', 'border-transparent');
                } else {
                    tab.classList.add('text-gray-500', 'border-transparent');
                    tab.classList.remove('text-primary', 'border-primary');
                }
            });
        }

        // æ ¼å¼åŒ–æ—¶é—´
        function formatTime(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hour = String(date.getHours()).padStart(2, '0');
            const minute = String(date.getMinutes()).padStart(2, '0');
            return `${year}-${month}-${day} ${hour}:${minute}`;
        }

        // è·å–æŠ•ç¥¨æ•°æ®
        async function fetchVoteData() {
            try {
                const response = await fetch('http://banming.tttttttttt.top/api/users/get.php');
                if (!response.ok) throw new Error('æŠ•ç¥¨æ•°æ®åŠ è½½å¤±è´¥');

                const data = await response.json();
                // æ ¼å¼åŒ–æŠ•ç¥¨æ•°æ®ä¸º { qq: { likes: 0, dislikes: 0 } }
                data.forEach(item => {
                    voteData[item.user_qq] = {
                        likes: item.likes || 0,
                        dislikes: item.dislikes || 0
                    };
                });

                console.log('æŠ•ç¥¨æ•°æ®åŠ è½½æˆåŠŸ:', voteData);
                return true;
            } catch (error) {
                console.error('æŠ•ç¥¨æ•°æ®åŠ è½½é”™è¯¯:', error);
                new LightTip('æŠ•ç¥¨æ•°æ®åŠ è½½å¤±è´¥ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½å—é™');
                return false;
            }
        }

        // æäº¤æŠ•ç¥¨
        async function submitVote(userQq, action) {
            // é˜²æ­¢é‡å¤æŠ•ç¥¨
            if (userVotes[userQq] === action) {
                new LightTip(`æ‚¨å·²ç»${action === 'like' ? 'ç‚¹èµ' : 'ç‚¹è¸©'}è¿‡äº†`);
                return;
            }

            try {
                // ç¦ç”¨æŒ‰é’®é˜²æ­¢é‡å¤æäº¤
                const likeBtn = document.getElementById(`like-${userQq}`);
                const dislikeBtn = document.getElementById(`dislike-${userQq}`);
                if (likeBtn) likeBtn.disabled = true;
                if (dislikeBtn) dislikeBtn.disabled = true;

                const url = `http://banming.tttttttttt.top/api/users/upload.php?user_qq=${userQq}&action=${action}`;
                const response = await fetch(url, {
                    method: 'GET'
                });

                const result = await response.text();

                // æ›´æ–°æœ¬åœ°æŠ•ç¥¨æ•°æ®
                if (!voteData[userQq]) {
                    voteData[userQq] = { likes: 0, dislikes: 0 };
                }

                // å¦‚æœä¹‹å‰æœ‰è¿‡å…¶ä»–æŠ•ç¥¨ï¼Œéœ€è¦å‡å»
                if (userVotes[userQq]) {
                    voteData[userQq][userVotes[userQq] + 's']--;
                }

                // æ›´æ–°å½“å‰æŠ•ç¥¨
                voteData[userQq][action + 's']++;
                userVotes[userQq] = action;

                // æ›´æ–°UI
                updateVoteUI(userQq);

                // æ˜¾ç¤ºç»“æœ
                new LightTip(message);

            } catch (error) {
                console.error('æŠ•ç¥¨æäº¤é”™è¯¯:', error);
                new LightTip('æŠ•ç¥¨å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
            } finally {
                // å¯ç”¨æŒ‰é’®
                const likeBtn = document.getElementById(`like-${userQq}`);
                const dislikeBtn = document.getElementById(`dislike-${userQq}`);
                if (likeBtn) likeBtn.disabled = false;
                if (dislikeBtn) dislikeBtn.disabled = false;
            }
        }

        // æ›´æ–°æŠ•ç¥¨UI
        function updateVoteUI(userQq) {
            const likeBtn = document.getElementById(`like-${userQq}`);
            const dislikeBtn = document.getElementById(`dislike-${userQq}`);
            const likeCount = document.getElementById(`like-count-${userQq}`);
            const dislikeCount = document.getElementById(`dislike-count-${userQq}`);

            if (!voteData[userQq]) return;

            // æ›´æ–°è®¡æ•°
            if (likeCount) likeCount.textContent = voteData[userQq].likes;
            if (dislikeCount) dislikeCount.textContent = voteData[userQq].dislikes;

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            if (likeBtn) {
                if (userVotes[userQq] === 'like') {
                    likeBtn.classList.add('liked');
                    dislikeBtn.classList.remove('disliked');
                } else {
                    likeBtn.classList.remove('liked');
                }
            }

            if (dislikeBtn) {
                if (userVotes[userQq] === 'dislike') {
                    dislikeBtn.classList.add('disliked');
                    likeBtn.classList.remove('liked');
                } else {
                    dislikeBtn.classList.remove('disliked');
                }
            }
        }

        // è¯·æ±‚æ•°æ®
        async function fetchSystemData() {
            try {
                tableBody.innerHTML = `
          <tr>
            <td colspan="5" class="py-16 text-center text-gray-500">
              <div class="animate-spin text-2xl mb-4 block">âŸ³</div>
              <p>æ•°æ®åŠ è½½ä¸­ï¼Œè¯·ç¨å€™...</p>
            </td>
          </tr>
        `;

                // å¹¶è¡ŒåŠ è½½äººå‘˜æ•°æ®å’ŒæŠ•ç¥¨æ•°æ®
                const [peopleResponse, voteSuccess] = await Promise.all([
                    fetch('./people.json'),
                    fetchVoteData()
                ]);

                if (!peopleResponse.ok) throw new Error('äººå‘˜æ•°æ®åŠ è½½å¤±è´¥');

                const peopleData = await peopleResponse.json();
                systemData = peopleData.people || {};

                const now = new Date();
                lastUpdate.textContent = `æœ€åæ›´æ–°ï¼š${formatTime(now)}`;

                renderTable();

            } catch (error) {
                tableBody.innerHTML = `
          <tr>
            <td colspan="5" class="py-16 text-center text-red-500">
              <div class="text-2xl mb-4 block">âŒ</div>
              <p>${error.message}</p>
              <button onclick="fetchSystemData()" class="mt-4 text-primary hover:underline">é‡è¯•</button>
            </td>
          </tr>
        `;
                console.error('æ•°æ®åŠ è½½é”™è¯¯:', error);
            }
        }

        // éšæœºæ’åºæ•°ç»„ï¼ˆFisher-Yates æ´—ç‰Œç®—æ³•ï¼‰
        function shuffleArray(array) {
            const newArray = [...array]; // é¿å…ä¿®æ”¹åŸæ•°ç»„
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]]; // äº¤æ¢å…ƒç´ 
            }
            return newArray;
        }

        // æ¸²æŸ“è¡¨æ ¼
        function renderTable() {
            const systems = Object.entries(systemData);

            let filteredSystems = shuffleArray(systems); // å…ˆæ•´ä½“éšæœºæ’åº

            if (searchKeyword.trim()) {
                const keyword = searchKeyword.trim().toLowerCase();
                filteredSystems = filteredSystems.filter(([name, config]) => // åŸºäºéšæœºåçš„æ•°ç»„ç­›é€‰
                    name.toLowerCase().includes(keyword) ||
                    (config.user_note && config.user_note.toLowerCase().includes(keyword))
                );
            }

            if (filteredSystems.length === 0) {
                tableBody.innerHTML = '';
                noResult.classList.remove('hidden');
                return;
            }

            noResult.classList.add('hidden');

            let tableHtml = '';
            filteredSystems.forEach(([name, config]) => {
                const userQq = config.user_qq || '';
                const votes = voteData[userQq] || { likes: 0, dislikes: 0 };
                const userVote = userVotes[userQq] || '';

                tableHtml += `
          <tr class="hover:bg-neutral/50 transition-all duration-300">
            <td class="py-4 px-6 font-medium text-lg">
              <img src="${config.user_qq_head_url || '../favicon.ico'}"
                   alt="${config.user_name || 'å¤´åƒ'}"
                   class="head_img"
                   onerror="this.src='../favicon.ico'"> <!-- å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºé»˜è®¤å¤´åƒ -->
            </td>
            <td class="py-4 px-6 text-center">${config.user_name || 'æœªå‘½å'}</td>
            <td class="py-4 px-6 text-center">
              <ui-tips title="å¤åˆ¶QQå·">
                <a href="javascript:copyText(${userQq})" class="text-primary hover:underline">
                  ${userQq || 'æœªæä¾›'}
                </a>
              </ui-tips>
            </td>
            <td class="py-4 px-6 text-center">${config.user_note || 'æ— æè¿°'}</td>
            <td class="py-4 px-6 text-center">
              <div class="flex items-center justify-center space-x-6">
                <button id="like-${userQq}" class="vote-btn ${userVote === 'like' ? 'liked' : ''}"
                        onclick="submitVote(${userQq}, 'like')"
                        ${!userQq ? 'disabled' : ''}>
                  ğŸ‘ <span id="like-count-${userQq}" class="vote-count">${votes.likes}</span>
                </button>
                <button id="dislike-${userQq}" class="vote-btn ${userVote === 'dislike' ? 'disliked' : ''}"
                        onclick="submitVote(${userQq}, 'dislike')"
                        ${!userQq ? 'disabled' : ''}>
                  ğŸ‘ <span id="dislike-count-${userQq}" class="vote-count">${votes.dislikes}</span>
                </button>
              </div>
            </td>
          </tr>
        `;
            });

            tableBody.innerHTML = tableHtml;

            // å…¥åœºåŠ¨ç”»
            const rows = tableBody.querySelectorAll('tr');
            rows.forEach((row, index) => {
                row.style.opacity = '0';
                row.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    row.style.transition = 'all 0.3s ease';
                    row.style.opacity = '1';
                    row.style.transform = 'translateY(0)';
                }, 50 * index);
            });
        }

        // æœç´¢åŠŸèƒ½
        searchInput.addEventListener('input', (e) => {
            searchKeyword = e.target.value;
            renderTable();
            clearSearch.classList.toggle('hidden', !searchKeyword.trim());
        });

        // æ¸…é™¤æœç´¢
        clearSearch.addEventListener('click', () => {
            searchInput.value = '';
            searchKeyword = '';
            clearSearch.classList.add('hidden');
            renderTable();
            searchInput.focus();
        });

        // å¼¹çª—æ§åˆ¶
        function showUpdateModal() {
            updateModal.classList.remove('hidden');
            setTimeout(() => {
                modalContent.classList.remove('scale-95', 'opacity-0');
                modalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        function hideUpdateModal() {
            modalContent.classList.remove('scale-100', 'opacity-100');
            modalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                updateModal.classList.add('hidden');
            }, 300);
        }

        // ç¡®è®¤æ›´æ–°
        confirmUpdate.addEventListener('click', () => {
            hideUpdateModal();
            fetchSystemData();
        });

        // å–æ¶ˆæ›´æ–°
        cancelUpdate.addEventListener('click', hideUpdateModal);

        // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
        updateModal.addEventListener('click', (e) => {
            if (e.target === updateModal) hideUpdateModal();
        });

        // ESCå…³é—­å¼¹çª—
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && !updateModal.classList.contains('hidden')) {
                hideUpdateModal();
            }
        });

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            // è®¾ç½®é»˜è®¤æ¿€æ´»çš„é€‰é¡¹å¡
            updateTabStatus(proxyTab);
            fetchSystemData();
            searchInput.focus();

            // æ¯å°æ—¶æç¤ºæ›´æ–°
            setInterval(showUpdateModal, 3600000);

            // ESCå…³é—­å¼¹çª—
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && !updateModal.classList.contains('hidden')) {
                    hideUpdateModal();
                }
            });
        });

        // å¤åˆ¶æ–‡æœ¬åˆ°å‰ªè´´æ¿
        function copyText(text) {
            if (navigator.clipboard && navigator.permissions) {
                // ä½¿ç”¨ClipboardApiå¤åˆ¶
                navigator.clipboard.writeText(text);
            } else {
                // æµè§ˆå™¨ä¸æ”¯æŒClipboardApiï¼Œä½¿ç”¨æ—§æ–¹å¼
                const textArea = document.createElement("textArea");
                textArea.value = text;
                textArea.style.width = 0;
                textArea.style.position = "fixed";
                textArea.style.left = "-999px";
                textArea.style.top = "10px";
                textArea.setAttribute("readonly", "readonly");
                document.body.appendChild(textArea);

                textArea.select();
                document.execCommand("copy");
                document.body.removeChild(textArea);
            }
            new LightTip('å·²å¤åˆ¶ï¼','success');
        }
    </script>
</body>

</html>